2025-03-18 20:46:22,221 - WARNING: Matplotlib is building the font cache; this may take a moment.
2025-03-18 20:46:26,156 - INFO: Failed to extract font properties from /System/Library/Fonts/Apple Color Emoji.ttc: Could not set the fontsize (invalid pixel size; error code 0x17)
2025-03-18 20:46:26,173 - INFO: Failed to extract font properties from /System/Library/Fonts/LastResort.otf: tuple indices must be integers or slices, not str
2025-03-18 20:46:26,233 - INFO: Failed to extract font properties from /System/Library/Fonts/Supplemental/NISC18030.ttf: Could not set the fontsize (invalid pixel size; error code 0x17)
2025-03-18 20:46:26,255 - INFO: Failed to extract font properties from /System/Library/PrivateFrameworks/FontServices.framework/Resources/Reserved/PingFangUI.ttc: Can not load face (locations (loca) table missing; error code 0x90)
2025-03-18 20:46:26,288 - INFO: generated new fontManager
2025-03-18 20:46:26,871 - INFO: Probando módulo de ingeniería de características...
2025-03-18 20:46:26,916 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:46:26,932 - INFO: Preprocesamiento exitoso: 33254 partidos
2025-03-18 20:46:31,055 - INFO: Estadísticas calculadas para 1175 jugadores
2025-03-18 20:46:31,494 - INFO: Estadísticas h2h calculadas para 16913 pares de jugadores
2025-03-18 20:46:31,494 - INFO: Extracción de características exitosa: 16 características
2025-03-18 20:46:36,665 - INFO: Preparación de datos exitosa: 33254 muestras, 16 características
2025-03-18 20:46:36,672 - INFO: Probando entrenamiento del modelo...
2025-03-18 20:46:36,672 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-18 20:46:36,691 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:46:41,789 - INFO: Datos preparados: 33254 muestras, 16 características
2025-03-18 20:46:41,795 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-18 20:46:42,544 - INFO: Entrenamiento completado - Accuracy: 1.0000
2025-03-18 20:46:42,548 - INFO: Modelo guardado correctamente en ml-service/model/model.pkl
2025-03-18 20:46:42,548 - INFO: Probando predicción...
2025-03-18 20:46:42,575 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:46:46,083 - INFO: Predicción exitosa: Nadal (1.00)
2025-03-18 20:48:55,149 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:48:55,751 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:48:55,765 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:48:55,767 - WARNING: Error cargando modelo: Modelo no encontrado en ml-service/model/model.pkl
2025-03-18 20:57:48,441 - INFO: Probando módulo de ingeniería de características...
2025-03-18 20:57:48,460 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:57:48,471 - INFO: Preprocesamiento exitoso: 33254 partidos
2025-03-18 20:57:52,600 - INFO: Estadísticas calculadas para 1175 jugadores
2025-03-18 20:57:53,048 - INFO: Estadísticas h2h calculadas para 16913 pares de jugadores
2025-03-18 20:57:53,048 - INFO: Extracción de características exitosa: 16 características
2025-03-18 20:57:58,241 - INFO: Preparación de datos exitosa: 33254 muestras, 16 características
2025-03-18 20:57:58,248 - INFO: Probando entrenamiento del modelo...
2025-03-18 20:57:58,248 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-18 20:57:58,266 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:58:03,322 - INFO: Datos preparados: 33254 muestras, 16 características
2025-03-18 20:58:03,328 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-18 20:58:03,658 - INFO: Entrenamiento completado - Accuracy: 1.0000
2025-03-18 20:58:03,662 - INFO: Modelo guardado correctamente en ml-service/model/model.pkl
2025-03-18 20:58:03,662 - INFO: Probando predicción...
2025-03-18 20:58:03,686 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33254 registros
2025-03-18 20:58:07,203 - INFO: Predicción exitosa: Nadal (1.00)
2025-03-18 20:58:26,726 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:58:27,243 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:58:27,254 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 20:58:27,255 - WARNING: Error cargando modelo: Modelo no encontrado en ml-service/model/model.pkl
2025-03-18 21:08:22,215 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-18 21:08:22,215 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:08:22,215 - ERROR: Error preparando datos: No hay datos para preparar
2025-03-18 21:08:22,215 - INFO: Usando método antiguo para preparar datos
2025-03-18 21:09:17,817 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-18 21:09:17,817 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:09:17,817 - ERROR: Error preparando datos: No hay datos para preparar
2025-03-18 21:09:17,817 - INFO: Usando método antiguo para preparar datos
2025-03-18 21:10:50,341 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-18 21:10:50,360 - INFO: Datos cargados desde tennis_matches.csv: 33254 registros
2025-03-18 21:10:55,561 - INFO: Datos preparados: 33254 muestras, 16 características
2025-03-18 21:10:55,567 - INFO: Iniciando optimización de hiperparámetros para RandomForest
2025-03-18 21:11:05,970 - INFO: Mejores parámetros encontrados: {'max_depth': None, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 100}
2025-03-18 21:11:06,182 - INFO: Entrenamiento completado - Accuracy: 1.0000
2025-03-18 21:12:02,836 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:12:03,329 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:12:03,339 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:12:03,433 - INFO: Modelo cargado correctamente
2025-03-18 21:12:06,161 - ERROR: Error en predicción: No hay datos para construir estadísticas de jugadores
2025-03-18 21:12:06,161 - INFO: Usando método básico para predicción
2025-03-18 21:12:06,161 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:12:06,161 - WARNING: No se pudieron calcular estadísticas: No hay datos para construir estadísticas de jugadores
2025-03-18 21:12:06,161 - WARNING: Error con características avanzadas, usando método básico: No hay datos para construir estadísticas de jugadores
2025-03-18 21:12:08,829 - ERROR: Error en predicción: No hay datos para construir estadísticas de jugadores
2025-03-18 21:12:08,829 - INFO: Usando método básico para predicción
2025-03-18 21:12:08,829 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:12:08,829 - WARNING: No se pudieron calcular estadísticas: No hay datos para construir estadísticas de jugadores
2025-03-18 21:12:08,829 - WARNING: Error con características avanzadas, usando método básico: No hay datos para construir estadísticas de jugadores
2025-03-18 21:14:40,382 - INFO: Modelo cargado correctamente
2025-03-18 21:14:40,401 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33254 registros
2025-03-18 21:14:44,533 - INFO: Estadísticas de jugadores calculadas correctamente
2025-03-18 21:14:48,948 - INFO: Modelo cargado correctamente
2025-03-18 21:14:48,966 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33254 registros
2025-03-18 21:14:52,928 - INFO: Estadísticas de jugadores calculadas correctamente
2025-03-18 21:15:57,707 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:15:57,716 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:15:57,808 - INFO: Modelo cargado correctamente
2025-03-18 21:15:57,826 - INFO: Datos cargados desde tennis_matches.csv: 33254 registros
2025-03-18 21:16:01,709 - INFO: Estadísticas de jugadores calculadas correctamente
2025-03-18 21:16:26,806 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-18 21:16:26,824 - INFO: Datos cargados desde tennis_matches.csv: 33254 registros
2025-03-18 21:16:31,784 - INFO: Datos preparados: 33254 muestras, 16 características
2025-03-18 21:16:31,789 - INFO: Iniciando optimización de hiperparámetros para RandomForest
2025-03-18 21:16:40,813 - INFO: Mejores parámetros encontrados: {'max_depth': None, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 100}
2025-03-18 21:16:41,021 - INFO: Entrenamiento completado - Accuracy: 1.0000
2025-03-18 21:16:44,197 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:16:44,692 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:16:44,701 - WARNING: Archivo de datos no encontrado: ml-service/tennis_matches.csv
2025-03-18 21:16:44,801 - INFO: Modelo cargado correctamente
2025-03-18 21:16:44,819 - INFO: Datos cargados desde tennis_matches.csv: 33254 registros
2025-03-18 21:16:48,664 - INFO: Estadísticas de jugadores calculadas correctamente
2025-03-19 11:47:16,786 - INFO: Probando módulo de ingeniería de características...
2025-03-19 11:47:16,804 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 11:47:16,816 - INFO: Preprocesamiento exitoso: 33244 partidos
2025-03-19 11:47:20,763 - INFO: Estadísticas calculadas para 1175 jugadores
2025-03-19 11:47:21,197 - INFO: Estadísticas h2h calculadas para 16913 pares de jugadores
2025-03-19 11:47:21,197 - INFO: Extracción de características exitosa: 16 características
2025-03-19 11:47:26,188 - INFO: Preparación de datos exitosa: 33244 muestras, 16 características
2025-03-19 11:47:26,195 - INFO: Probando entrenamiento del modelo...
2025-03-19 11:47:26,195 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-19 11:47:26,195 - WARNING: Archivo de datos no encontrado: tennis_matches.csv
2025-03-19 11:47:26,195 - ERROR: Error preparando datos: No hay datos para preparar
2025-03-19 11:47:26,195 - INFO: Usando método antiguo para preparar datos
2025-03-19 11:47:26,196 - INFO: Probando predicción...
2025-03-19 11:47:26,221 - INFO: Datos cargados desde ml-service/tennis_matches.csv: 33244 registros
2025-03-19 11:47:29,674 - INFO: Predicción exitosa: Nadal (1.00)
2025-03-19 12:11:08,014 - INFO: Probando módulo de ingeniería de características...
2025-03-19 12:11:08,048 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:11:08,055 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:11:08,055 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:11:08,055 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:11:08,055 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:11:08,057 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:11:08,058 - INFO: Preprocesamiento exitoso: 33191 partidos
2025-03-19 12:11:11,769 - INFO: Estadísticas calculadas para 1164 jugadores
2025-03-19 12:11:12,208 - INFO: Estadísticas h2h calculadas para 16861 pares de jugadores
2025-03-19 12:11:12,208 - INFO: Extracción de características exitosa: 16 características
2025-03-19 12:11:12,216 - WARNING: Se detectaron 131 valores nulos en ranking_1
2025-03-19 12:11:12,217 - WARNING: Se detectaron 344 valores nulos en ranking_2
2025-03-19 12:11:12,217 - WARNING: Se detectaron 1976 valores nulos en winrate_1
2025-03-19 12:11:12,217 - WARNING: Se detectaron 1976 valores nulos en winrate_2
2025-03-19 12:11:16,960 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:11:16,966 - INFO: Preparación de datos exitosa: 33191 muestras, 16 características
2025-03-19 12:11:16,976 - INFO: Probando entrenamiento del modelo...
2025-03-19 12:11:16,995 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-19 12:11:16,995 - INFO: Usando archivo de datos: /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv
2025-03-19 12:11:17,012 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:11:17,012 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 12:11:17,019 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:11:17,019 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:11:17,019 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:11:17,019 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:11:17,021 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:11:21,809 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:11:21,815 - INFO: Datos preparados: 33191 muestras, 16 características
2025-03-19 12:11:21,816 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 12:11:21,822 - INFO: Conjunto de entrenamiento: 26552 muestras
2025-03-19 12:11:21,822 - INFO: Conjunto de prueba: 6639 muestras
2025-03-19 12:11:21,822 - INFO: Usando modelo: RandomForest
2025-03-19 12:11:21,822 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-19 12:11:21,928 - INFO: Evaluando modelo en conjunto de prueba...
2025-03-19 12:11:21,940 - INFO: Métricas de rendimiento:
2025-03-19 12:11:21,940 - INFO: - Accuracy: 1.0000
2025-03-19 12:11:21,940 - INFO: - Precision: 1.0000
2025-03-19 12:11:21,940 - INFO: - Recall: 1.0000
2025-03-19 12:11:21,940 - INFO: - F1 Score: 1.0000
2025-03-19 12:11:21,949 - INFO: Modelo guardado en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 12:11:21,949 - INFO: Metadatos guardados en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/training_metadata.json
2025-03-19 12:11:21,949 - INFO: Lista de características guardada en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/feature_names.txt
2025-03-19 12:11:21,949 - ERROR: Error generando visualizaciones: cannot access local variable 'plt' where it is not associated with a value
2025-03-19 12:11:21,950 - ERROR: Error en entrenamiento del modelo: cannot access local variable 'features_df' where it is not associated with a value
2025-03-19 12:11:21,950 - ERROR: Traceback (most recent call last):
  File "/Users/miquelroca/Desktop/tennis-predictor/ml-service/test_system.py", line 135, in test_model_training
    model = train_model(data_path=DATA_PATH, optimize_hyperparams=False)
  File "/Users/miquelroca/Desktop/tennis-predictor/ml-service/train.py", line 460, in train_model
    for i, (_, row) in enumerate(features_df.head(5).iterrows()):
                                 ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'features_df' where it is not associated with a value

2025-03-19 12:11:21,954 - INFO: Probando predicción...
2025-03-19 12:11:21,978 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:11:25,472 - INFO: Predicción exitosa: Novak Djokovic (1.00)
2025-03-19 12:11:39,684 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-19 12:11:39,684 - INFO: Usando archivo de datos: /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv
2025-03-19 12:11:39,701 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:11:39,701 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 12:11:39,708 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:11:39,708 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:11:39,708 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:11:39,708 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:11:39,710 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:11:44,357 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:11:44,363 - INFO: Datos preparados: 33191 muestras, 16 características
2025-03-19 12:11:44,364 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 12:11:44,369 - INFO: Conjunto de entrenamiento: 26552 muestras
2025-03-19 12:11:44,369 - INFO: Conjunto de prueba: 6639 muestras
2025-03-19 12:11:44,369 - INFO: Usando modelo: RandomForest
2025-03-19 12:11:44,369 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-19 12:11:44,482 - INFO: Evaluando modelo en conjunto de prueba...
2025-03-19 12:11:44,491 - INFO: Métricas de rendimiento:
2025-03-19 12:11:44,491 - INFO: - Accuracy: 1.0000
2025-03-19 12:11:44,491 - INFO: - Precision: 1.0000
2025-03-19 12:11:44,491 - INFO: - Recall: 1.0000
2025-03-19 12:11:44,491 - INFO: - F1 Score: 1.0000
2025-03-19 12:11:44,500 - INFO: Modelo guardado en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 12:11:44,500 - INFO: Metadatos guardados en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/training_metadata.json
2025-03-19 12:11:44,501 - INFO: Lista de características guardada en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/feature_names.txt
2025-03-19 12:11:44,501 - ERROR: Error generando visualizaciones: cannot access local variable 'plt' where it is not associated with a value
2025-03-19 12:17:49,834 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-19 12:17:49,834 - INFO: Usando archivo de datos: /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv
2025-03-19 12:17:49,851 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:17:49,851 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 12:17:49,858 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:17:49,858 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:17:49,858 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:17:49,858 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:17:49,860 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:17:54,568 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:17:54,574 - INFO: Datos preparados: 33191 muestras, 16 características
2025-03-19 12:17:54,575 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 12:17:54,580 - INFO: Conjunto de entrenamiento: 26552 muestras
2025-03-19 12:17:54,580 - INFO: Conjunto de prueba: 6639 muestras
2025-03-19 12:17:54,580 - INFO: Usando modelo: RandomForest
2025-03-19 12:17:54,580 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-19 12:17:54,685 - INFO: Evaluando modelo en conjunto de prueba...
2025-03-19 12:17:54,694 - INFO: Métricas de rendimiento:
2025-03-19 12:17:54,694 - INFO: - Accuracy: 1.0000
2025-03-19 12:17:54,694 - INFO: - Precision: 1.0000
2025-03-19 12:17:54,694 - INFO: - Recall: 1.0000
2025-03-19 12:17:54,694 - INFO: - F1 Score: 1.0000
2025-03-19 12:17:54,703 - INFO: Modelo guardado en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 12:17:54,703 - INFO: Metadatos guardados en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/training_metadata.json
2025-03-19 12:17:54,703 - INFO: Lista de características guardada en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/feature_names.txt
2025-03-19 12:17:54,703 - ERROR: Error generando visualizaciones: cannot access local variable 'plt' where it is not associated with a value
2025-03-19 12:17:54,703 - INFO: Entrenamiento completado exitosamente
2025-03-19 12:18:03,136 - INFO: Probando módulo de ingeniería de características...
2025-03-19 12:18:03,170 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:18:03,177 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:18:03,177 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:18:03,177 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:18:03,177 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:18:03,179 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:18:03,180 - INFO: Preprocesamiento exitoso: 33191 partidos
2025-03-19 12:18:06,859 - INFO: Estadísticas calculadas para 1164 jugadores
2025-03-19 12:18:07,290 - INFO: Estadísticas h2h calculadas para 16861 pares de jugadores
2025-03-19 12:18:07,290 - INFO: Extracción de características exitosa: 16 características
2025-03-19 12:18:07,298 - WARNING: Se detectaron 131 valores nulos en ranking_1
2025-03-19 12:18:07,298 - WARNING: Se detectaron 344 valores nulos en ranking_2
2025-03-19 12:18:07,298 - WARNING: Se detectaron 1976 valores nulos en winrate_1
2025-03-19 12:18:07,298 - WARNING: Se detectaron 1976 valores nulos en winrate_2
2025-03-19 12:18:12,059 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:18:12,066 - INFO: Preparación de datos exitosa: 33191 muestras, 16 características
2025-03-19 12:18:12,076 - INFO: Probando entrenamiento del modelo...
2025-03-19 12:18:12,095 - INFO: Iniciando entrenamiento con rf (optimizar=False)
2025-03-19 12:18:12,095 - INFO: Usando archivo de datos: /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv
2025-03-19 12:18:12,112 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:18:12,112 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 12:18:12,119 - WARNING: Se detectaron 139 valores nulos en ranking_1
2025-03-19 12:18:12,119 - WARNING: Se detectaron 356 valores nulos en ranking_2
2025-03-19 12:18:12,119 - WARNING: Se detectaron 2009 valores nulos en winrate_1
2025-03-19 12:18:12,119 - WARNING: Se detectaron 2009 valores nulos en winrate_2
2025-03-19 12:18:12,121 - WARNING: Eliminando 53 filas con valores nulos en columnas esenciales
2025-03-19 12:18:16,900 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 12:18:16,906 - INFO: Datos preparados: 33191 muestras, 16 características
2025-03-19 12:18:16,907 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 12:18:16,912 - INFO: Conjunto de entrenamiento: 26552 muestras
2025-03-19 12:18:16,912 - INFO: Conjunto de prueba: 6639 muestras
2025-03-19 12:18:16,912 - INFO: Usando modelo: RandomForest
2025-03-19 12:18:16,912 - INFO: Entrenando RandomForest con parámetros por defecto
2025-03-19 12:18:17,023 - INFO: Evaluando modelo en conjunto de prueba...
2025-03-19 12:18:17,033 - INFO: Métricas de rendimiento:
2025-03-19 12:18:17,033 - INFO: - Accuracy: 1.0000
2025-03-19 12:18:17,033 - INFO: - Precision: 1.0000
2025-03-19 12:18:17,033 - INFO: - Recall: 1.0000
2025-03-19 12:18:17,033 - INFO: - F1 Score: 1.0000
2025-03-19 12:18:17,042 - INFO: Modelo guardado en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 12:18:17,043 - INFO: Metadatos guardados en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/training_metadata.json
2025-03-19 12:18:17,043 - INFO: Lista de características guardada en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/feature_names.txt
2025-03-19 12:18:17,043 - ERROR: Error generando visualizaciones: cannot access local variable 'plt' where it is not associated with a value
2025-03-19 12:18:17,043 - INFO: Entrenamiento completado exitosamente
2025-03-19 12:18:17,046 - INFO: Modelo guardado correctamente en /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 12:18:17,047 - INFO: Probando predicción...
2025-03-19 12:18:17,072 - INFO: Datos cargados desde /Users/miquelroca/Desktop/tennis-predictor/ml-service/tennis_matches.csv: 33244 registros
2025-03-19 12:18:20,661 - INFO: Predicción exitosa: Novak Djokovic (1.00)
2025-03-19 13:15:40,600 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-19 13:15:40,600 - INFO: Usando archivo de datos: balanced_data.csv
2025-03-19 13:15:40,634 - INFO: Datos cargados desde balanced_data.csv: 66488 registros
2025-03-19 13:15:40,634 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 13:15:40,651 - WARNING: Se detectaron 495 valores nulos en ranking_1
2025-03-19 13:15:40,651 - WARNING: Se detectaron 495 valores nulos en ranking_2
2025-03-19 13:15:40,651 - WARNING: Se detectaron 4018 valores nulos en winrate_1
2025-03-19 13:15:40,651 - WARNING: Se detectaron 4018 valores nulos en winrate_2
2025-03-19 13:15:40,655 - WARNING: Eliminando 106 filas con valores nulos en columnas esenciales
2025-03-19 13:15:40,658 - INFO: Distribución de clases: clase 0 (player1 gana): 50.00%, clase 1 (player2 gana): 50.00%
2025-03-19 13:15:47,954 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 13:15:47,967 - INFO: Datos preparados: 66382 muestras, 16 características
2025-03-19 13:15:47,968 - INFO: Distribución de clases: winner
0    33191
1    33191
Name: count, dtype: int64
2025-03-19 13:15:47,968 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 13:15:47,980 - INFO: Conjunto de entrenamiento: 53105 muestras (Distribución: [26552 26553])
2025-03-19 13:15:47,980 - INFO: Conjunto de prueba: 13277 muestras (Distribución: [6639 6638])
2025-03-19 13:15:47,980 - INFO: Usando modelo: RandomForest
2025-03-19 13:15:47,980 - INFO: Iniciando optimización de hiperparámetros para RandomForest
2025-03-19 13:15:47,980 - INFO: Iniciando búsqueda de hiperparámetros (puede tardar varios minutos)...
2025-03-19 13:26:00,527 - INFO: Iniciando entrenamiento con rf (optimizar=True)
2025-03-19 13:26:00,527 - INFO: Usando archivo de datos: balanced_data.csv
2025-03-19 13:26:00,563 - INFO: Datos cargados desde balanced_data.csv: 66488 registros
2025-03-19 13:26:00,564 - INFO: Preparando datos con ingeniería de características avanzada...
2025-03-19 13:26:00,579 - WARNING: Se detectaron 495 valores nulos en ranking_1
2025-03-19 13:26:00,579 - WARNING: Se detectaron 495 valores nulos en ranking_2
2025-03-19 13:26:00,579 - WARNING: Se detectaron 4018 valores nulos en winrate_1
2025-03-19 13:26:00,579 - WARNING: Se detectaron 4018 valores nulos en winrate_2
2025-03-19 13:26:00,583 - WARNING: Eliminando 106 filas con valores nulos en columnas esenciales
2025-03-19 13:26:00,585 - INFO: Distribución de clases: clase 0 (player1 gana): 50.00%, clase 1 (player2 gana): 50.00%
2025-03-19 13:26:07,847 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 13:26:07,859 - INFO: Datos preparados: 66382 muestras, 16 características
2025-03-19 13:26:07,860 - INFO: Distribución de clases: winner
0    33191
1    33191
Name: count, dtype: int64
2025-03-19 13:26:07,860 - INFO: Dividiendo datos en entrenamiento (80.0%) y prueba (20.0%)
2025-03-19 13:26:07,871 - INFO: Conjunto de entrenamiento: 53105 muestras (Distribución: [26552 26553])
2025-03-19 13:26:07,871 - INFO: Conjunto de prueba: 13277 muestras (Distribución: [6639 6638])
2025-03-19 13:26:07,871 - INFO: Usando modelo: RandomForest
2025-03-19 13:26:07,871 - INFO: Iniciando optimización de hiperparámetros para RandomForest
2025-03-19 13:26:07,871 - INFO: Iniciando búsqueda de hiperparámetros (puede tardar varios minutos)...
2025-03-19 13:43:56,898 - INFO: Mejores parámetros encontrados: {'max_depth': None, 'max_features': 'sqrt', 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 200}
2025-03-19 13:43:56,899 - INFO: Evaluando modelo en conjunto de prueba...
2025-03-19 13:43:57,508 - INFO: Métricas de rendimiento:
2025-03-19 13:43:57,509 - INFO: - Accuracy: 0.7817
2025-03-19 13:43:57,509 - INFO: - Precision: 0.7817
2025-03-19 13:43:57,509 - INFO: - Recall: 0.7817
2025-03-19 13:43:57,509 - INFO: - F1 Score: 0.7817
2025-03-19 13:43:57,561 - INFO: Modelo guardado en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/model.pkl
2025-03-19 13:43:57,562 - INFO: Metadatos guardados en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/training_metadata.json
2025-03-19 13:43:57,562 - INFO: Lista de características guardada en: /Users/miquelroca/Desktop/tennis-predictor/ml-service/model/feature_names.txt
2025-03-19 13:43:57,562 - ERROR: Error generando visualizaciones: cannot access local variable 'plt' where it is not associated with a value
2025-03-19 13:43:57,563 - INFO: Entrenamiento completado exitosamente
2025-03-19 13:47:27,861 - ERROR: Error cargando datos externos: No se encontró el archivo de datos externos: external_data.csv
2025-03-19 13:47:27,861 - ERROR: Error en la evaluación del modelo: No se encontró el archivo de datos externos: external_data.csv
2025-03-19 13:47:43,601 - INFO: Datos cargados desde balanced_data.csv: 66488 registros
2025-03-19 13:47:43,616 - WARNING: Se detectaron 495 valores nulos en ranking_1
2025-03-19 13:47:43,616 - WARNING: Se detectaron 495 valores nulos en ranking_2
2025-03-19 13:47:43,616 - WARNING: Se detectaron 4018 valores nulos en winrate_1
2025-03-19 13:47:43,616 - WARNING: Se detectaron 4018 valores nulos en winrate_2
2025-03-19 13:47:43,620 - WARNING: Eliminando 106 filas con valores nulos en columnas esenciales
2025-03-19 13:47:43,622 - INFO: Distribución de clases: clase 0 (player1 gana): 50.00%, clase 1 (player2 gana): 50.00%
2025-03-19 13:47:50,993 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 13:47:51,287 - INFO: Datos cargados desde balanced_data.csv: 66488 registros
2025-03-19 13:47:51,304 - WARNING: Se detectaron 495 valores nulos en ranking_1
2025-03-19 13:47:51,304 - WARNING: Se detectaron 495 valores nulos en ranking_2
2025-03-19 13:47:51,304 - WARNING: Se detectaron 4018 valores nulos en winrate_1
2025-03-19 13:47:51,304 - WARNING: Se detectaron 4018 valores nulos en winrate_2
2025-03-19 13:47:51,308 - WARNING: Eliminando 106 filas con valores nulos en columnas esenciales
2025-03-19 13:47:51,310 - INFO: Distribución de clases: clase 0 (player1 gana): 50.00%, clase 1 (player2 gana): 50.00%
2025-03-19 13:47:58,625 - WARNING: Se detectaron valores NaN en las características, imputando con 0
2025-03-19 13:51:48,612 - INFO: Datos cargados desde balanced_data.csv: 66488 registros
2025-03-19 13:51:48,628 - WARNING: Se detectaron 495 valores nulos en ranking_1
2025-03-19 13:51:48,628 - WARNING: Se detectaron 495 valores nulos en ranking_2
2025-03-19 13:51:48,628 - WARNING: Se detectaron 4018 valores nulos en winrate_1
2025-03-19 13:51:48,628 - WARNING: Se detectaron 4018 valores nulos en winrate_2
2025-03-19 13:51:48,631 - WARNING: Eliminando 106 filas con valores nulos en columnas esenciales
2025-03-19 13:51:48,634 - INFO: Distribución de clases: clase 0 (player1 gana): 50.00%, clase 1 (player2 gana): 50.00%
2025-03-19 13:51:55,910 - WARNING: Se detectaron valores NaN en las características, imputando con 0
